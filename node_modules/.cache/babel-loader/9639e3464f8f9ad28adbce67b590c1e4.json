{"ast":null,"code":"import _objectWithoutProperties from \"/home/a11one/reverb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"/home/a11one/reverb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/a11one/reverb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/a11one/reverb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/a11one/reverb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/a11one/reverb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/a11one/reverb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/a11one/reverb/src/components/Songs/Songs.js\";\nimport React, { Component } from 'react';\nimport { Button, FormGroup, Input, Form } from 'reactstrap';\nimport { AuthUserContext } from '../Session';\nimport { withFirebase } from '../Firebase';\nimport SongList from './SongList';\n\nvar Songs =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Songs, _Component);\n\n  function Songs(props) {\n    var _this;\n\n    _classCallCheck(this, Songs);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Songs).call(this, props));\n\n    _this.onListenForSongs = function () {\n      _this.setState({\n        loading: true\n      });\n\n      _this.props.firebase.songs().orderByChild('createdAt').limitToLast(_this.state.limit).on('value', function (snapshot) {\n        var songObject = snapshot.val();\n\n        if (songObject) {\n          var songList = Object.keys(songObject).map(function (key) {\n            return _objectSpread({}, songObject[key], {\n              uid: key\n            });\n          });\n\n          _this.setState({\n            songs: songList,\n            loading: false\n          });\n        } else {\n          _this.setState({\n            songs: null,\n            loading: false\n          });\n        }\n      });\n    };\n\n    _this.onChangeText = function (event) {\n      _this.setState({\n        streaming_song: event.target.value\n      });\n    };\n\n    _this.onCreateSong = function (event, authUser) {\n      _this.props.firebase.songs().push({\n        streaming_song: _this.state.streaming_song,\n        userId: authUser.uid,\n        createdAt: _this.props.firebase.serverValue.TIMESTAMP\n      });\n\n      _this.setState({\n        streaming_song: ''\n      });\n\n      event.preventDefault();\n    };\n\n    _this.onEditSong = function (song, streaming_song) {\n      var uid = song.uid,\n          songSnapshot = _objectWithoutProperties(song, [\"uid\"]);\n\n      _this.props.firebase.song(song.uid).set(_objectSpread({}, songSnapshot, {\n        streaming_song: streaming_song,\n        editedAt: _this.props.firebase.serverValue.TIMESTAMP\n      }));\n    };\n\n    _this.onRemoveSong = function (uid) {\n      _this.props.firebase.song(uid).remove();\n    };\n\n    _this.onNextPage = function () {\n      _this.setState(function (state) {\n        return {\n          limit: state.limit + 5\n        };\n      }, _this.onListenForSongs);\n    };\n\n    _this.state = {\n      streaming_song: '',\n      loading: false,\n      songs: [],\n      limit: 5\n    };\n    return _this;\n  }\n\n  _createClass(Songs, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.onListenForSongs();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.props.firebase.songs().off();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          streaming_song = _this$state.streaming_song,\n          songs = _this$state.songs,\n          loading = _this$state.loading;\n      return React.createElement(AuthUserContext.Consumer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, function (authUser) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 96\n          },\n          __self: this\n        }, !loading && songs && React.createElement(Button, {\n          type: \"button\",\n          onClick: _this2.onNextPage,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98\n          },\n          __self: this\n        }, \"More\"), loading && React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 103\n          },\n          __self: this\n        }, \"Loading ...\"), songs && React.createElement(SongList, {\n          authUser: authUser,\n          songs: songs,\n          onEditSong: _this2.onEditSong,\n          onRemoveSong: _this2.onRemoveSong,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 106\n          },\n          __self: this\n        }), !songs && React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114\n          },\n          __self: this\n        }, \"There are no songs ...\"), React.createElement(Form, {\n          inline: true,\n          onSubmit: function onSubmit(event) {\n            return _this2.onCreateSong(event, authUser);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 116\n          },\n          __self: this\n        }, React.createElement(Input, {\n          type: \"text\",\n          value: streaming_song,\n          onChange: _this2.onChangeText,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121\n          },\n          __self: this\n        }), React.createElement(Button, {\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        }, \"Send\")));\n      });\n    }\n  }]);\n\n  return Songs;\n}(Component);\n\nexport default withFirebase(Songs);","map":{"version":3,"sources":["/home/a11one/reverb/src/components/Songs/Songs.js"],"names":["React","Component","Button","FormGroup","Input","Form","AuthUserContext","withFirebase","SongList","Songs","props","onListenForSongs","setState","loading","firebase","songs","orderByChild","limitToLast","state","limit","on","snapshot","songObject","val","songList","Object","keys","map","key","uid","onChangeText","event","streaming_song","target","value","onCreateSong","authUser","push","userId","createdAt","serverValue","TIMESTAMP","preventDefault","onEditSong","song","songSnapshot","set","editedAt","onRemoveSong","remove","onNextPage","off"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Button, FormGroup, Input, Form } from 'reactstrap';\nimport { AuthUserContext } from '../Session';\nimport { withFirebase } from '../Firebase';\nimport SongList from './SongList';\n\nclass Songs extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      streaming_song: '',\n      loading: false,\n      songs: [],\n      limit: 5,\n    };\n  }\n\n  componentDidMount() {\n    this.onListenForSongs();\n  }\n\n  onListenForSongs = () => {\n    this.setState({ loading: true });\n\n    this.props.firebase\n      .songs()\n      .orderByChild('createdAt')\n      .limitToLast(this.state.limit)\n      .on('value', snapshot => {\n        const songObject = snapshot.val();\n\n        if (songObject) {\n          const songList = Object.keys(songObject).map(key => ({\n            ...songObject[key],\n            uid: key,\n          }));\n\n          this.setState({\n            songs: songList,\n            loading: false,\n          });\n        } else {\n          this.setState({ songs: null, loading: false });\n        }\n      });\n  };\n\n  componentWillUnmount() {\n    this.props.firebase.songs().off();\n  }\n\n  onChangeText = event => {\n    this.setState({ streaming_song: event.target.value });\n  };\n\n  onCreateSong = (event, authUser) => {\n    this.props.firebase.songs().push({\n      streaming_song: this.state.streaming_song,\n      userId: authUser.uid,\n      createdAt: this.props.firebase.serverValue.TIMESTAMP,\n    });\n\n    this.setState({ streaming_song: '' });\n\n    event.preventDefault();\n  };\n\n  onEditSong = (song, streaming_song) => {\n    const { uid, ...songSnapshot } = song;\n\n    this.props.firebase.song(song.uid).set({\n      ...songSnapshot,\n      streaming_song,\n      editedAt: this.props.firebase.serverValue.TIMESTAMP,\n    });\n  };\n\n  onRemoveSong = uid => {\n    this.props.firebase.song(uid).remove();\n  };\n\n  onNextPage = () => {\n    this.setState(\n      state => ({ limit: state.limit + 5 }),\n      this.onListenForSongs,\n    );\n  };\n\n  render() {\n    const { streaming_song, songs, loading } = this.state;\n\n    return (\n      <AuthUserContext.Consumer>\n        {authUser => (\n          <div>\n            {!loading && songs && (\n              <Button type=\"button\" onClick={this.onNextPage}>\n                More\n              </Button>\n            )}\n\n            {loading && <div>Loading ...</div>}\n\n            {songs && (\n              <SongList\n                authUser={authUser}\n                songs={songs}\n                onEditSong={this.onEditSong}\n                onRemoveSong={this.onRemoveSong}\n              />\n            )}\n\n            {!songs && <div>There are no songs ...</div>}\n\n            <Form inline\n              onSubmit={event =>\n                this.onCreateSong(event, authUser)\n              }\n            >\n              <Input\n                type=\"text\"\n                value={streaming_song}\n                onChange={this.onChangeText}\n              />\n              <Button type=\"submit\">Send</Button>\n            </Form>\n          </div>\n        )}\n      </AuthUserContext.Consumer>\n    );\n  }\n  }\n\n  export default withFirebase(Songs);\n"]},"metadata":{},"sourceType":"module"}