{"ast":null,"code":"import _objectWithoutProperties from \"/home/a11one/reverb-CS701/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"/home/a11one/reverb-CS701/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/a11one/reverb-CS701/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/a11one/reverb-CS701/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/a11one/reverb-CS701/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/a11one/reverb-CS701/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/a11one/reverb-CS701/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/a11one/reverb-CS701/src/components/Messages/Messages.js\";\nimport React, { Component } from 'react';\nimport { Button, Input, Form } from 'reactstrap';\nimport { AuthUserContext } from '../Session';\nimport { withFirebase } from '../Firebase';\nimport MessageList from './MessageList';\nvar isStreaming = false;\n\nvar Messages =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Messages, _Component);\n\n  function Messages(props) {\n    var _this;\n\n    _classCallCheck(this, Messages);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Messages).call(this, props));\n\n    _this.onListenForMessages = function () {\n      _this.setState({\n        loading: true\n      });\n\n      _this.props.firebase.messages().orderByChild('createdAt').limitToLast(_this.state.limit).on('value', function (snapshot) {\n        var messageObject = snapshot.val();\n\n        if (messageObject) {\n          var messageList = Object.keys(messageObject).map(function (key) {\n            return _objectSpread({}, messageObject[key], {\n              uid: key\n            });\n          });\n\n          _this.setState({\n            messages: messageList,\n            loading: false\n          });\n        } else {\n          _this.setState({\n            messages: null,\n            loading: false\n          });\n        }\n      });\n    };\n\n    _this.onChangeText = function (event) {\n      _this.setState({\n        text: _this.state.text\n      });\n    };\n\n    _this.onCreateMessage = function (event, authUser) {\n      _this.props.firebase.messages().push({\n        text: _this.state.text,\n        userId: authUser.uid,\n        userName: authUser.username,\n        streamSong: _this.state.streamSong,\n        streamTitle: _this.state.streamTitle,\n        streamArtist: _this.state.streamArtist,\n        createdAt: _this.props.firebase.serverValue.TIMESTAMP\n      });\n\n      _this.setState({\n        text: _this.state.streamTitle\n      });\n\n      event.preventDefault();\n    };\n\n    _this.onEditMessage = function (message, text) {\n      var uid = message.uid,\n          messageSnapshot = _objectWithoutProperties(message, [\"uid\"]);\n\n      _this.props.firebase.message(message.uid).set(_objectSpread({}, messageSnapshot, {\n        text: text,\n        editedAt: _this.props.firebase.serverValue.TIMESTAMP\n      }));\n    };\n\n    _this.onRemoveMessage = function (uid) {\n      _this.props.firebase.message(uid).remove();\n    };\n\n    _this.onNextPage = function () {\n      _this.setState(function (state) {\n        return {\n          limit: state.limit + 5\n        };\n      }, _this.onListenForMessages);\n    };\n\n    _this.state = {\n      text: props.streamTitle,\n      loading: false,\n      messages: [],\n      limit: 5,\n      streamSong: props.streamSong,\n      streamTitle: props.streamTitle,\n      streamArtist: props.streamArtist\n    };\n    return _this;\n  }\n\n  _createClass(Messages, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.onListenForMessages();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.props.firebase.messages().off();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          text = _this$state.text,\n          messages = _this$state.messages,\n          loading = _this$state.loading,\n          streamSong = _this$state.streamSong,\n          streamTile = _this$state.streamTile,\n          streamArtist = _this$state.streamArtist;\n      return React.createElement(AuthUserContext.Consumer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }, function (authUser) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 105\n          },\n          __self: this\n        }, !loading && messages && React.createElement(Button, {\n          type: \"button\",\n          onClick: _this2.onNextPage,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107\n          },\n          __self: this\n        }, \"More\"), loading && React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112\n          },\n          __self: this\n        }, \"Loading ...\"), messages && React.createElement(MessageList, {\n          authUser: authUser,\n          messages: messages,\n          onEditMessage: _this2.onEditMessage,\n          onRemoveMessage: _this2.onRemoveMessage,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 115\n          },\n          __self: this\n        }), !messages && React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123\n          },\n          __self: this\n        }, \"There are no messages ...\"), React.createElement(Form, {\n          inline: true,\n          onSubmit: function onSubmit(event) {\n            return _this2.onCreateMessage(event, authUser);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125\n          },\n          __self: this\n        }, React.createElement(Input, {\n          type: \"text\",\n          value: text,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        }), React.createElement(Button, {\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 134\n          },\n          __self: this\n        }, \"Send\"), React.createElement(Button, {\n          color: \"warning\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135\n          },\n          __self: this\n        }, \"Stream Now\"), React.createElement(Button, {\n          disable: isStreaming,\n          color: \"danger\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 136\n          },\n          __self: this\n        }, \" Stop Stream\")));\n      });\n    }\n  }]);\n\n  return Messages;\n}(Component);\n\nexport default withFirebase(Messages); // <Input\n//   type=\"text\"\n//   value={text}\n//   onChange={this.onChangeText}\n// />\n// <Button type=\"submit\">Send</Button>\n// <Button color=\"warning\">Stream Now</Button>\n// <Button disable={isStreaming} color=\"danger\"> Stop Stream</Button>","map":{"version":3,"sources":["/home/a11one/reverb-CS701/src/components/Messages/Messages.js"],"names":["React","Component","Button","Input","Form","AuthUserContext","withFirebase","MessageList","isStreaming","Messages","props","onListenForMessages","setState","loading","firebase","messages","orderByChild","limitToLast","state","limit","on","snapshot","messageObject","val","messageList","Object","keys","map","key","uid","onChangeText","event","text","onCreateMessage","authUser","push","userId","userName","username","streamSong","streamTitle","streamArtist","createdAt","serverValue","TIMESTAMP","preventDefault","onEditMessage","message","messageSnapshot","set","editedAt","onRemoveMessage","remove","onNextPage","off","streamTile"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Button, Input, Form } from 'reactstrap';\nimport { AuthUserContext } from '../Session';\nimport { withFirebase } from '../Firebase';\nimport MessageList from './MessageList';\n\nvar isStreaming = false;\n\nclass Messages extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      text: props.streamTitle,\n      loading: false,\n      messages: [],\n      limit: 5,\n      streamSong: props.streamSong,\n      streamTitle: props.streamTitle,\n      streamArtist: props.streamArtist,\n    };\n  }\n\n  componentDidMount() {\n    this.onListenForMessages();\n  }\n\n  onListenForMessages = () => {\n    this.setState({ loading: true });\n\n    this.props.firebase\n      .messages()\n      .orderByChild('createdAt')\n      .limitToLast(this.state.limit)\n      .on('value', snapshot => {\n        const messageObject = snapshot.val();\n\n        if (messageObject) {\n          const messageList = Object.keys(messageObject).map(key => ({\n            ...messageObject[key],\n            uid: key,\n          }));\n\n          this.setState({\n            messages: messageList,\n            loading: false,\n          });\n        } else {\n          this.setState({ messages: null, loading: false });\n        }\n      });\n  };\n\n  componentWillUnmount() {\n    this.props.firebase.messages().off();\n  }\n\n  onChangeText = event => {\n    this.setState({text: this.state.text});\n  };\n\n  onCreateMessage = (event, authUser) => {\n    this.props.firebase.messages().push({\n      text: this.state.text,\n      userId: authUser.uid,\n      userName: authUser.username,\n      streamSong: this.state.streamSong,\n      streamTitle: this.state.streamTitle,\n      streamArtist: this.state.streamArtist,\n      createdAt: this.props.firebase.serverValue.TIMESTAMP,\n    });\n\n    this.setState({ text: this.state.streamTitle });\n\n    event.preventDefault();\n  };\n\n  onEditMessage = (message, text) => {\n    const { uid, ...messageSnapshot } = message;\n\n    this.props.firebase.message(message.uid).set({\n      ...messageSnapshot,\n      text,\n      editedAt: this.props.firebase.serverValue.TIMESTAMP,\n    });\n  };\n\n  onRemoveMessage = uid => {\n    this.props.firebase.message(uid).remove();\n  };\n\n  onNextPage = () => {\n    this.setState(\n      state => ({ limit: state.limit + 5 }),\n      this.onListenForMessages,\n    );\n  };\n\n  render() {\n    const { text, messages, loading, streamSong, streamTile, streamArtist } = this.state;\n\n    return (\n      <AuthUserContext.Consumer>\n        {authUser => (\n          <div>\n            {!loading && messages && (\n              <Button type=\"button\" onClick={this.onNextPage}>\n                More\n              </Button>\n            )}\n\n            {loading && <div>Loading ...</div>}\n\n            {messages && (\n              <MessageList\n                authUser={authUser}\n                messages={messages}\n                onEditMessage={this.onEditMessage}\n                onRemoveMessage={this.onRemoveMessage}\n              />\n            )}\n\n            {!messages && <div>There are no messages ...</div>}\n\n            <Form inline\n              onSubmit={event =>\n                this.onCreateMessage(event, authUser)\n              }\n            >\n            <Input\n              type=\"text\"\n              value={text}\n            />\n            <Button type=\"submit\">Send</Button>\n            <Button color=\"warning\">Stream Now</Button>\n            <Button disable={isStreaming} color=\"danger\"> Stop Stream</Button>\n            </Form>\n          </div>\n        )}\n      </AuthUserContext.Consumer>\n    );\n  }\n}\n\nexport default withFirebase(Messages);\n\n// <Input\n//   type=\"text\"\n//   value={text}\n//   onChange={this.onChangeText}\n// />\n// <Button type=\"submit\">Send</Button>\n// <Button color=\"warning\">Stream Now</Button>\n// <Button disable={isStreaming} color=\"danger\"> Stop Stream</Button>\n"]},"metadata":{},"sourceType":"module"}